<!DOCTYPE html>
<html lang="zh-TW">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>æ¸¬è©¦ç”¨å„€è¡¨æ¿</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/vue@3"></script>
  <script src="https://cdn.jsdelivr.net/npm/echarts@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vuedraggable@4.1.0/dist/vuedraggable.umd.min.js"></script>
  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
  <script src="https://unpkg.com/lucide@latest"></script>

  <style>
    html, body {
      min-height: 100%;
    }
    .drag-ghost {
    @apply opacity-40 scale-95;
    }
    .drag-chosen {
    @apply ring-2 ring-primary-500;
    }
  </style>
</head>

<body class="min-h-screen p-8 text-blue-600">
  <div id="app" class="max-w-7xl mx-auto space-y-6">
    <h1 class="text-4xl font-bold text-center text-blue-600">
      WIP Load Data Chart
    </h1>

    <!-- ğŸ¯ ç¯©é¸åˆ— -->
    <div
      class="flex flex-wrap items-end justify-center gap-4 bg-white/60 rounded-lg p-4 shadow">
      <div>
        <label class="block text-sm mb-1">æ£Ÿåˆ¥</label>
        <select v-model="filters.building" @change="onFilterChange"
          class="px-3 py-2 bg-white border rounded">
          <option value="">å…¨éƒ¨</option>
          <option v-for="b in options.buildings" :key="b" :value="b">{{ b }}</option>
        </select>
      </div>

      <div>
        <label class="block text-sm mb-1">æ¨“å±¤</label>
        <select v-model="filters.floor" @change="onFilterChange"
          class="px-3 py-2 bg-white border rounded">
          <option value="">å…¨éƒ¨</option>
          <option v-for="f in options.floors" :key="f" :value="f">{{ f }}</option>
        </select>
      </div>

      <div>
        <label class="block text-sm mb-1">ç«™é»</label>
        <select v-model="filters.station" @change="onFilterChange"
          class="px-3 py-2 bg-white border rounded">
          <option value="">å…¨éƒ¨</option>
          <option v-for="s in options.stations" :key="s" :value="s">{{ s }}</option>
        </select>
      </div>

      <div>
        <label class="block text-sm mb-1">å„²æ ¼</label>
        <select v-model="filters.storage"
          class="px-3 py-2 bg-white border rounded">
          <option disabled value="">â† å…ˆé¸ä¸‰å±¤</option>
          <option v-for="c in storageOptions" :key="c" :value="c">{{ c }}</option>
        </select>
      </div>

      <button
        @click="addChart"
        class="px-4 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-40"
        :disabled="!filters.storage">
        åŠ å…¥åœ–è¡¨
      </button>

      <button
        @click="clearAll"
        class="px-4 py-2 rounded bg-red-600 text-white hover:bg-red-700">
        æ¸…é™¤å…¨éƒ¨
      </button>
    </div>

    <!-- ğŸ¯ åœ–è¡¨å€ï¼ˆä¿æŒåŸæœ¬çš„ draggableï¼‰ -->
    <draggable
      :list="charts"
      item-key="id"
      :animation="200"
      ghost-class="drag-ghost"
      chosen-class="drag-chosen"
      @end="renderAll"
      class="flex flex-wrap gap-4"
    >
      <template #item="{ element, index }">
    <div
      :class="[
          'bg-white p-4 rounded shadow relative group animate-fade-in min-w-0',
          charts[index].expanded ? 'w-full' : 'w-[calc(50%-0.5rem)]'
        ]"
      data-aos="fade-up"
    >
          <div class="absolute top-2 right-2 hidden group-hover:flex gap-2 items-center">
            <button @click="toggleSize(index)" class="text-sm px-2 py-1 bg-gray-200 rounded hover:bg-gray-300">
              {{ charts[index].expanded ? 'ç¸®å°åœ–è¡¨' : 'æ”¾å¤§åœ–è¡¨' }}
            </button>
            <button @click="removeChart(index)">
              <i data-lucide="trash" class="w-5 h-5 text-red-500"></i>
            </button>
          </div>
          <h3 class="text-lg font-bold mb-2 text-blue-600">{{ element.title }}</h3>
          <div :id="`chart-${element.id}`" :class="['w-full', charts[index].expanded ? 'h-[32rem]' : 'h-64']"></div>
        </div>
      </template>
    </draggable>
  </div>

  <script src="app.js"></script>
</body>

</html>
